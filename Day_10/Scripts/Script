-- Day 10
### Practice Questions:

-- 1. Categorise patients as 'High', 'Medium', or 'Low' satisfaction based on their scores
SELECT patient_id,name,satisfaction,
CASE WHEN satisfaction>=90 then "HIGH"
     WHEN satisfaction>=70 then "MEDIUM"
     ELSE "LOW"
     END as Satisfaction_Category
FROM patients;

-- 2. Label staff roles as 'Medical' or 'Support' based on role type.
select * from staff_schedule;
SELECT distinct staff_name,
CASE WHEN role="doctor" then "Medical"
	 ELSE "Support"
     END as staff_role_type
FROM staff_schedule;
-- 3. Create age groups for patients (0-18, 19-40, 41-65, 65+).
Select name,age,
CASE WHEN age between 0 and 18 then "Childreen"
     WHEN age between 19 and 40 then "Young Adult"
     WHEN age between 41 and 65 then "Middle-aged Adult"
     ELSE "Senior"
     END as age_category
FROM patients;

### Daily Challenge:

-- **Question:** Create a service performance report showing service name, total patients admitted, and a performance category based 
-- on the following: 'Excellent' if avg satisfaction >= 85, 'Good' if >= 75, 'Fair' if >= 65, otherwise 'Needs Improvement'. 
-- Order by average satisfaction descending.
SELECT service,sum(patients_admitted) as admitted_patients,avg(patient_satisfaction) as avg_satisfaction,
CASE 
    WHEN avg(patient_satisfaction) >= 85 then  "EXCELLENT"
    WHEN avg(patient_satisfaction) >= 75 then   "GOOD"
    WHEN avg(patient_satisfaction) >= 65 then  "FAIR"
    ELSE "NEEDS IMPROVEMENT" END as satisfaction_performace_category
FROM services_weekly
GROUP BY service
ORDER BY avg_satisfaction desc;
 
