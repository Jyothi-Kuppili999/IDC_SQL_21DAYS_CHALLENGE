-- Day6
### Practice Questions:

-- 1. Count the number of patients by each service.
SELECT service,COUNT(patient_id) as patient_count 
FROM patients
Group by service;
-- 2. Calculate the average age of patients grouped by service.
SELECT service,ROUND(AVG(age),2) as patient_avg_age 
FROM patients
Group by service;
-- 3. Find the total number of staff members per role.
SELECT role,count(staff_id) as total_staff
FROM staff
Group by role;

### Daily Challenge:

-- **Question:** For each hospital service, calculate the total number of patients admitted, total patients refused, 
-- and the admission rate (percentage of requests that were admitted). Order by admission rate descending.

SELECT
    service,
    SUM(patients_admitted) as total_admitted,
    SUM(patients_refused) as total_refused,
    ROUND((SUM(patients_admitted)/SUM(patients_request))*100,2) as admission_rate
    FROM services_weekly
    Group by service
    Order by admission_rate desc;
