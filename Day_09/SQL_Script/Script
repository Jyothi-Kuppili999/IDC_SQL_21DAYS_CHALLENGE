-- Day9
### Practice Questions:

-- 1. Extract the year from all patient arrival dates.
SELECT patient_id,year(arrival_date) as Arrival_Year
FROM patients;
-- 2. Calculate the length of stay for each patient (departure_date - arrival_date).
SELECT patient_id,CONCAT(DATEDIFF(departure_date,arrival_date),' days') as duration
FROM patients;
-- 3. Find all patients who arrived in a specific month.
SELECT patient_id, name,arrival_date
FROM patients
WHERE DATE_FORMAT(arrival_date, '%m') = '05';


### Daily Challenge:

-- **Question:** Calculate the average length of stay (in days) for each service, 
-- showing only services where the average stay is more than 7 days. Also show the count of patients and order by average stay descending.
SELECT service,ROUND(AVG(datediff(departure_date,arrival_date)),2) as avg_stay,count(patient_id) as patient_count
FROM patients
group by service
having avg_stay>7
order by avg_stay desc;

